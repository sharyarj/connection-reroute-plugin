{"version":3,"file":"connection-reroute-plugin.min.js","sources":["../node_modules/d3-path/src/path.js","../node_modules/d3-shape/src/constant.js","../node_modules/d3-shape/src/math.js","../node_modules/d3-shape/src/curve/linear.js","../node_modules/d3-shape/src/point.js","../node_modules/d3-shape/src/curve/cardinal.js","../node_modules/d3-shape/src/curve/catmullRom.js","../node_modules/d3-shape/src/curve/monotone.js","../src/Pin.vue","../node_modules/vue-runtime-helpers/dist/normalize-component.js","../node_modules/vue-runtime-helpers/dist/inject-style/browser.js","../src/utils.js","../src/index.js","../node_modules/d3-shape/src/line.js"],"sourcesContent":["var pi = Math.PI,\n    tau = 2 * pi,\n    epsilon = 1e-6,\n    tauEpsilon = tau - epsilon;\n\nfunction Path() {\n  this._x0 = this._y0 = // start of current subpath\n  this._x1 = this._y1 = null; // end of current subpath\n  this._ = \"\";\n}\n\nfunction path() {\n  return new Path;\n}\n\nPath.prototype = path.prototype = {\n  constructor: Path,\n  moveTo: function(x, y) {\n    this._ += \"M\" + (this._x0 = this._x1 = +x) + \",\" + (this._y0 = this._y1 = +y);\n  },\n  closePath: function() {\n    if (this._x1 !== null) {\n      this._x1 = this._x0, this._y1 = this._y0;\n      this._ += \"Z\";\n    }\n  },\n  lineTo: function(x, y) {\n    this._ += \"L\" + (this._x1 = +x) + \",\" + (this._y1 = +y);\n  },\n  quadraticCurveTo: function(x1, y1, x, y) {\n    this._ += \"Q\" + (+x1) + \",\" + (+y1) + \",\" + (this._x1 = +x) + \",\" + (this._y1 = +y);\n  },\n  bezierCurveTo: function(x1, y1, x2, y2, x, y) {\n    this._ += \"C\" + (+x1) + \",\" + (+y1) + \",\" + (+x2) + \",\" + (+y2) + \",\" + (this._x1 = +x) + \",\" + (this._y1 = +y);\n  },\n  arcTo: function(x1, y1, x2, y2, r) {\n    x1 = +x1, y1 = +y1, x2 = +x2, y2 = +y2, r = +r;\n    var x0 = this._x1,\n        y0 = this._y1,\n        x21 = x2 - x1,\n        y21 = y2 - y1,\n        x01 = x0 - x1,\n        y01 = y0 - y1,\n        l01_2 = x01 * x01 + y01 * y01;\n\n    // Is the radius negative? Error.\n    if (r < 0) throw new Error(\"negative radius: \" + r);\n\n    // Is this path empty? Move to (x1,y1).\n    if (this._x1 === null) {\n      this._ += \"M\" + (this._x1 = x1) + \",\" + (this._y1 = y1);\n    }\n\n    // Or, is (x1,y1) coincident with (x0,y0)? Do nothing.\n    else if (!(l01_2 > epsilon));\n\n    // Or, are (x0,y0), (x1,y1) and (x2,y2) collinear?\n    // Equivalently, is (x1,y1) coincident with (x2,y2)?\n    // Or, is the radius zero? Line to (x1,y1).\n    else if (!(Math.abs(y01 * x21 - y21 * x01) > epsilon) || !r) {\n      this._ += \"L\" + (this._x1 = x1) + \",\" + (this._y1 = y1);\n    }\n\n    // Otherwise, draw an arc!\n    else {\n      var x20 = x2 - x0,\n          y20 = y2 - y0,\n          l21_2 = x21 * x21 + y21 * y21,\n          l20_2 = x20 * x20 + y20 * y20,\n          l21 = Math.sqrt(l21_2),\n          l01 = Math.sqrt(l01_2),\n          l = r * Math.tan((pi - Math.acos((l21_2 + l01_2 - l20_2) / (2 * l21 * l01))) / 2),\n          t01 = l / l01,\n          t21 = l / l21;\n\n      // If the start tangent is not coincident with (x0,y0), line to.\n      if (Math.abs(t01 - 1) > epsilon) {\n        this._ += \"L\" + (x1 + t01 * x01) + \",\" + (y1 + t01 * y01);\n      }\n\n      this._ += \"A\" + r + \",\" + r + \",0,0,\" + (+(y01 * x20 > x01 * y20)) + \",\" + (this._x1 = x1 + t21 * x21) + \",\" + (this._y1 = y1 + t21 * y21);\n    }\n  },\n  arc: function(x, y, r, a0, a1, ccw) {\n    x = +x, y = +y, r = +r, ccw = !!ccw;\n    var dx = r * Math.cos(a0),\n        dy = r * Math.sin(a0),\n        x0 = x + dx,\n        y0 = y + dy,\n        cw = 1 ^ ccw,\n        da = ccw ? a0 - a1 : a1 - a0;\n\n    // Is the radius negative? Error.\n    if (r < 0) throw new Error(\"negative radius: \" + r);\n\n    // Is this path empty? Move to (x0,y0).\n    if (this._x1 === null) {\n      this._ += \"M\" + x0 + \",\" + y0;\n    }\n\n    // Or, is (x0,y0) not coincident with the previous point? Line to (x0,y0).\n    else if (Math.abs(this._x1 - x0) > epsilon || Math.abs(this._y1 - y0) > epsilon) {\n      this._ += \"L\" + x0 + \",\" + y0;\n    }\n\n    // Is this arc empty? Weâ€™re done.\n    if (!r) return;\n\n    // Does the angle go the wrong way? Flip the direction.\n    if (da < 0) da = da % tau + tau;\n\n    // Is this a complete circle? Draw two arcs to complete the circle.\n    if (da > tauEpsilon) {\n      this._ += \"A\" + r + \",\" + r + \",0,1,\" + cw + \",\" + (x - dx) + \",\" + (y - dy) + \"A\" + r + \",\" + r + \",0,1,\" + cw + \",\" + (this._x1 = x0) + \",\" + (this._y1 = y0);\n    }\n\n    // Is this arc non-empty? Draw an arc!\n    else if (da > epsilon) {\n      this._ += \"A\" + r + \",\" + r + \",0,\" + (+(da >= pi)) + \",\" + cw + \",\" + (this._x1 = x + r * Math.cos(a1)) + \",\" + (this._y1 = y + r * Math.sin(a1));\n    }\n  },\n  rect: function(x, y, w, h) {\n    this._ += \"M\" + (this._x0 = this._x1 = +x) + \",\" + (this._y0 = this._y1 = +y) + \"h\" + (+w) + \"v\" + (+h) + \"h\" + (-w) + \"Z\";\n  },\n  toString: function() {\n    return this._;\n  }\n};\n\nexport default path;\n","export default function(x) {\n  return function constant() {\n    return x;\n  };\n}\n","export var abs = Math.abs;\nexport var atan2 = Math.atan2;\nexport var cos = Math.cos;\nexport var max = Math.max;\nexport var min = Math.min;\nexport var sin = Math.sin;\nexport var sqrt = Math.sqrt;\n\nexport var epsilon = 1e-12;\nexport var pi = Math.PI;\nexport var halfPi = pi / 2;\nexport var tau = 2 * pi;\n\nexport function acos(x) {\n  return x > 1 ? 0 : x < -1 ? pi : Math.acos(x);\n}\n\nexport function asin(x) {\n  return x >= 1 ? halfPi : x <= -1 ? -halfPi : Math.asin(x);\n}\n","function Linear(context) {\n  this._context = context;\n}\n\nLinear.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; // proceed\n      default: this._context.lineTo(x, y); break;\n    }\n  }\n};\n\nexport default function(context) {\n  return new Linear(context);\n}\n","export function x(p) {\n  return p[0];\n}\n\nexport function y(p) {\n  return p[1];\n}\n","export function point(that, x, y) {\n  that._context.bezierCurveTo(\n    that._x1 + that._k * (that._x2 - that._x0),\n    that._y1 + that._k * (that._y2 - that._y0),\n    that._x2 + that._k * (that._x1 - x),\n    that._y2 + that._k * (that._y1 - y),\n    that._x2,\n    that._y2\n  );\n}\n\nexport function Cardinal(context, tension) {\n  this._context = context;\n  this._k = (1 - tension) / 6;\n}\n\nCardinal.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 =\n    this._y0 = this._y1 = this._y2 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 2: this._context.lineTo(this._x2, this._y2); break;\n      case 3: point(this, this._x1, this._y1); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; this._x1 = x, this._y1 = y; break;\n      case 2: this._point = 3; // proceed\n      default: point(this, x, y); break;\n    }\n    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;\n    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;\n  }\n};\n\nexport default (function custom(tension) {\n\n  function cardinal(context) {\n    return new Cardinal(context, tension);\n  }\n\n  cardinal.tension = function(tension) {\n    return custom(+tension);\n  };\n\n  return cardinal;\n})(0);\n","import {epsilon} from \"../math\";\nimport {Cardinal} from \"./cardinal\";\n\nexport function point(that, x, y) {\n  var x1 = that._x1,\n      y1 = that._y1,\n      x2 = that._x2,\n      y2 = that._y2;\n\n  if (that._l01_a > epsilon) {\n    var a = 2 * that._l01_2a + 3 * that._l01_a * that._l12_a + that._l12_2a,\n        n = 3 * that._l01_a * (that._l01_a + that._l12_a);\n    x1 = (x1 * a - that._x0 * that._l12_2a + that._x2 * that._l01_2a) / n;\n    y1 = (y1 * a - that._y0 * that._l12_2a + that._y2 * that._l01_2a) / n;\n  }\n\n  if (that._l23_a > epsilon) {\n    var b = 2 * that._l23_2a + 3 * that._l23_a * that._l12_a + that._l12_2a,\n        m = 3 * that._l23_a * (that._l23_a + that._l12_a);\n    x2 = (x2 * b + that._x1 * that._l23_2a - x * that._l12_2a) / m;\n    y2 = (y2 * b + that._y1 * that._l23_2a - y * that._l12_2a) / m;\n  }\n\n  that._context.bezierCurveTo(x1, y1, x2, y2, that._x2, that._y2);\n}\n\nfunction CatmullRom(context, alpha) {\n  this._context = context;\n  this._alpha = alpha;\n}\n\nCatmullRom.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 =\n    this._y0 = this._y1 = this._y2 = NaN;\n    this._l01_a = this._l12_a = this._l23_a =\n    this._l01_2a = this._l12_2a = this._l23_2a =\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 2: this._context.lineTo(this._x2, this._y2); break;\n      case 3: this.point(this._x2, this._y2); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n\n    if (this._point) {\n      var x23 = this._x2 - x,\n          y23 = this._y2 - y;\n      this._l23_a = Math.sqrt(this._l23_2a = Math.pow(x23 * x23 + y23 * y23, this._alpha));\n    }\n\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; // proceed\n      default: point(this, x, y); break;\n    }\n\n    this._l01_a = this._l12_a, this._l12_a = this._l23_a;\n    this._l01_2a = this._l12_2a, this._l12_2a = this._l23_2a;\n    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;\n    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;\n  }\n};\n\nexport default (function custom(alpha) {\n\n  function catmullRom(context) {\n    return alpha ? new CatmullRom(context, alpha) : new Cardinal(context, 0);\n  }\n\n  catmullRom.alpha = function(alpha) {\n    return custom(+alpha);\n  };\n\n  return catmullRom;\n})(0.5);\n","function sign(x) {\n  return x < 0 ? -1 : 1;\n}\n\n// Calculate the slopes of the tangents (Hermite-type interpolation) based on\n// the following paper: Steffen, M. 1990. A Simple Method for Monotonic\n// Interpolation in One Dimension. Astronomy and Astrophysics, Vol. 239, NO.\n// NOV(II), P. 443, 1990.\nfunction slope3(that, x2, y2) {\n  var h0 = that._x1 - that._x0,\n      h1 = x2 - that._x1,\n      s0 = (that._y1 - that._y0) / (h0 || h1 < 0 && -0),\n      s1 = (y2 - that._y1) / (h1 || h0 < 0 && -0),\n      p = (s0 * h1 + s1 * h0) / (h0 + h1);\n  return (sign(s0) + sign(s1)) * Math.min(Math.abs(s0), Math.abs(s1), 0.5 * Math.abs(p)) || 0;\n}\n\n// Calculate a one-sided slope.\nfunction slope2(that, t) {\n  var h = that._x1 - that._x0;\n  return h ? (3 * (that._y1 - that._y0) / h - t) / 2 : t;\n}\n\n// According to https://en.wikipedia.org/wiki/Cubic_Hermite_spline#Representations\n// \"you can express cubic Hermite interpolation in terms of cubic BÃ©zier curves\n// with respect to the four values p0, p0 + m0 / 3, p1 - m1 / 3, p1\".\nfunction point(that, t0, t1) {\n  var x0 = that._x0,\n      y0 = that._y0,\n      x1 = that._x1,\n      y1 = that._y1,\n      dx = (x1 - x0) / 3;\n  that._context.bezierCurveTo(x0 + dx, y0 + dx * t0, x1 - dx, y1 - dx * t1, x1, y1);\n}\n\nfunction MonotoneX(context) {\n  this._context = context;\n}\n\nMonotoneX.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 =\n    this._y0 = this._y1 =\n    this._t0 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 2: this._context.lineTo(this._x1, this._y1); break;\n      case 3: point(this, this._t0, slope2(this, this._t0)); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    var t1 = NaN;\n\n    x = +x, y = +y;\n    if (x === this._x1 && y === this._y1) return; // Ignore coincident points.\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; point(this, slope2(this, t1 = slope3(this, x, y)), t1); break;\n      default: point(this, this._t0, t1 = slope3(this, x, y)); break;\n    }\n\n    this._x0 = this._x1, this._x1 = x;\n    this._y0 = this._y1, this._y1 = y;\n    this._t0 = t1;\n  }\n}\n\nfunction MonotoneY(context) {\n  this._context = new ReflectContext(context);\n}\n\n(MonotoneY.prototype = Object.create(MonotoneX.prototype)).point = function(x, y) {\n  MonotoneX.prototype.point.call(this, y, x);\n};\n\nfunction ReflectContext(context) {\n  this._context = context;\n}\n\nReflectContext.prototype = {\n  moveTo: function(x, y) { this._context.moveTo(y, x); },\n  closePath: function() { this._context.closePath(); },\n  lineTo: function(x, y) { this._context.lineTo(y, x); },\n  bezierCurveTo: function(x1, y1, x2, y2, x, y) { this._context.bezierCurveTo(y1, x1, y2, x2, y, x); }\n};\n\nexport function monotoneX(context) {\n  return new MonotoneX(context);\n}\n\nexport function monotoneY(context) {\n  return new MonotoneY(context);\n}\n","<template lang=\"pug\">\n.pin(\n  :style=\"{left: pin.x+'px', top: pin.y+'px'}\"\n  @pointerdown=\"down\"\n  @pointerup=\"pinup\"\n)\n</template>\n\n\n<script>\nconst State = { PICKED: 0, MOVED: 1, DROPED: 2}\n\nexport default {\n  props: ['pin', 'change', 'remove'],\n  inject: ['editor', 'connection'],\n  data() {\n    return {\n      state: State.DROPED\n    }\n  },\n  mounted() {\n    window.addEventListener('pointermove', this.move);\n    window.addEventListener('pointerup', this.up);\n  },\n  destroyed() {\n    window.removeEventListener('pointermove', this.move);\n    window.removeEventListener('pointerup', this.up);\n  },\n  methods: {\n    setPosition(x, y) {\n      this.$emit('change', {x, y});\n      this.$forceUpdate();\n    },\n    down(e){\n      e.stopPropagation();\n      this.state = State.PICKED;\n    },\n    move(e){\n      if(this.state === State.DROPED) return;\n\n      this.state = State.MOVED;\n      e.preventDefault();\n\n      const { mouse } = this.editor.view.area;\n\n      this.setPosition(mouse.x, mouse.y);\n    },\n    up(e) {\n      this.state = State.DROPED;\n    },\n    pinup() {\n      if(this.state === State.MOVED) return;\n\n      this.$emit('remove', this.pin);\n    }\n  }\n}\n</script>\n\n\n<style lang=\"sass\" scoped>\n$size: 20px\n\n.pin\n  position: absolute\n  display: inline\n  width: $size\n  height: $size\n  background: lighten(steelblue, 20%)\n  border-radius: 50%\n  transform: translate(-50%, -50%)\n</style>\n","'use strict';\n\nfunction normalizeComponent(template, style, script, scopeId, isFunctionalTemplate, moduleIdentifier\n/* server only */\n, shadowMode, createInjector, createInjectorSSR, createInjectorShadow) {\n  if (typeof shadowMode !== 'boolean') {\n    createInjectorSSR = createInjector;\n    createInjector = shadowMode;\n    shadowMode = false;\n  } // Vue.extend constructor export interop.\n\n\n  var options = typeof script === 'function' ? script.options : script; // render functions\n\n  if (template && template.render) {\n    options.render = template.render;\n    options.staticRenderFns = template.staticRenderFns;\n    options._compiled = true; // functional template\n\n    if (isFunctionalTemplate) {\n      options.functional = true;\n    }\n  } // scopedId\n\n\n  if (scopeId) {\n    options._scopeId = scopeId;\n  }\n\n  var hook;\n\n  if (moduleIdentifier) {\n    // server build\n    hook = function hook(context) {\n      // 2.3 injection\n      context = context || // cached call\n      this.$vnode && this.$vnode.ssrContext || // stateful\n      this.parent && this.parent.$vnode && this.parent.$vnode.ssrContext; // functional\n      // 2.2 with runInNewContext: true\n\n      if (!context && typeof __VUE_SSR_CONTEXT__ !== 'undefined') {\n        context = __VUE_SSR_CONTEXT__;\n      } // inject component styles\n\n\n      if (style) {\n        style.call(this, createInjectorSSR(context));\n      } // register component module identifier for async chunk inference\n\n\n      if (context && context._registeredComponents) {\n        context._registeredComponents.add(moduleIdentifier);\n      }\n    }; // used by ssr in case component is cached and beforeCreate\n    // never gets called\n\n\n    options._ssrRegister = hook;\n  } else if (style) {\n    hook = shadowMode ? function () {\n      style.call(this, createInjectorShadow(this.$root.$options.shadowRoot));\n    } : function (context) {\n      style.call(this, createInjector(context));\n    };\n  }\n\n  if (hook) {\n    if (options.functional) {\n      // register for functional component in vue file\n      var originalRender = options.render;\n\n      options.render = function renderWithStyleInjection(h, context) {\n        hook.call(context);\n        return originalRender(h, context);\n      };\n    } else {\n      // inject component registration as beforeCreate hook\n      var existing = options.beforeCreate;\n      options.beforeCreate = existing ? [].concat(existing, hook) : [hook];\n    }\n  }\n\n  return script;\n}\n\nmodule.exports = normalizeComponent;\n//# sourceMappingURL=normalize-component.js.map\n","'use strict';\n\nvar isOldIE = typeof navigator !== 'undefined' && /msie [6-9]\\\\b/.test(navigator.userAgent.toLowerCase());\nfunction createInjector(context) {\n  return function (id, style) {\n    return addStyle(id, style);\n  };\n}\nvar HEAD = document.head || document.getElementsByTagName('head')[0];\nvar styles = {};\n\nfunction addStyle(id, css) {\n  var group = isOldIE ? css.media || 'default' : id;\n  var style = styles[group] || (styles[group] = {\n    ids: new Set(),\n    styles: []\n  });\n\n  if (!style.ids.has(id)) {\n    style.ids.add(id);\n    var code = css.source;\n\n    if (css.map) {\n      // https://developer.chrome.com/devtools/docs/javascript-debugging\n      // this makes source maps inside style tags work properly in Chrome\n      code += '\\n/*# sourceURL=' + css.map.sources[0] + ' */'; // http://stackoverflow.com/a/26603875\n\n      code += '\\n/*# sourceMappingURL=data:application/json;base64,' + btoa(unescape(encodeURIComponent(JSON.stringify(css.map)))) + ' */';\n    }\n\n    if (!style.element) {\n      style.element = document.createElement('style');\n      style.element.type = 'text/css';\n      if (css.media) style.element.setAttribute('media', css.media);\n      HEAD.appendChild(style.element);\n    }\n\n    if ('styleSheet' in style.element) {\n      style.styles.push(code);\n      style.element.styleSheet.cssText = style.styles.filter(Boolean).join('\\n');\n    } else {\n      var index = style.ids.size - 1;\n      var textNode = document.createTextNode(code);\n      var nodes = style.element.childNodes;\n      if (nodes[index]) style.element.removeChild(nodes[index]);\n      if (nodes.length) style.element.insertBefore(textNode, nodes[index]);else style.element.appendChild(textNode);\n    }\n  }\n}\n\nmodule.exports = createInjector;\n//# sourceMappingURL=browser.js.map\n","export function findRightIndexBack(point, line = []) {\n    let minIdx = -1;\n    let minDist = Infinity\n    for (let index = 0; index < line.length; index++) {\n        const point1 = line[index];\n        let dist = distance(point, point1)\n        if (dist < minDist) {\n            minIdx = index\n            minDist = dist\n        }\n    }\n    if (minIdx === 0) {\n        return 0\n    }\n    if (minIdx === line.length - 1) {\n        return minIdx - 1\n    }\n    let leftDistBwtTarget = distance(point, line[minIdx - 1])\n    let leftDistBwtMinIdx = distance(line[minIdx], line[minIdx - 1])\n    if (leftDistBwtTarget < leftDistBwtMinIdx) {\n        return minIdx - 1\n    }\n\n    return minIdx\n}\n\nexport function distance(point0, point1) {\n    return Math.sqrt(Math.pow(point1.x - point0.x, 2) + Math.pow(point1.y - point0.y, 2))\n}\n\nexport function findRightIndex(point, line = []) {\n    let minIdx = -1;\n    let minDist = Infinity\n    for (let index = 0; index < line.length - 1; index++) {\n        if (pointInBound(point, line[index], line[index + 1])) {\n            let dist = distanceToLine(point, line[index], line[index + 1])\n            if (dist < minDist) {\n                minIdx = index\n                minDist = dist\n            }\n        }\n\n    }\n    if (minIdx === -1) {\n        return findRightIndexBack(point, line)\n    }\n    return minIdx\n}\n\nexport function pointInBound(p0, p1, p2) {\n    let { x: x1, y: y1 } = p1\n    let { x: x2, y: y2 } = p2\n    let { x: x0, y: y0 } = p0\n    if (x1 < x0 && x0 < x2 && y1 < y0 && y0 < y2) {\n        return true\n    }\n    if (x2 < x0 && x0 < x1 && y2 < y0 && y0 < y1) {\n        return true\n    }\n    if (x1 < x0 && x0 < x2 && y1 > y0 && y0 > y2) {\n        return true\n    }\n    if (x2 < x0 && x0 < x1 && y2 > y0 && y0 > y1) {\n        return true\n    }\n\n    return false\n}\n\nexport function distanceToLine(p0, p1, p2) {\n    let top = (p2.y - p1.y) * p0.x\n        - (p2.x - p1.x) * p0.y\n        + p2.x * p1.y\n        - p2.y * p1.x\n    let bot = Math.pow((p2.y - p1.y), 2) + Math.pow((p2.x - p1.x), 2)\n    return Math.abs(top) / Math.sqrt(bot)\n}\n\nexport function alignEndsHorizontally(points, curvature) {\n    const p1 = points[0];\n    const p2 = points[1];\n    const p3 = points[points.length - 2];\n    const p4 = points[points.length - 1];\n    const hx1 = p1[0] + Math.abs(p2[0] - p1[0]) * curvature;\n    const hx2 = p4[0] - Math.abs(p4[0] - p3[0]) * curvature;\n\n    points = [...points];\n    points.splice(1, 0, [hx1, p1[1]]);\n    points.splice(points.length - 1, 0, [hx2, p4[1]]);\n\n    return points;\n}","import Vue from 'vue';\nimport * as d3 from 'd3-shape';\nimport Pins from './Pins.vue';\nimport { findRightIndex, alignEndsHorizontally } from './utils';\n\nfunction install(editor, { curve = d3.curveCatmullRom.alpha(1), curvature = 0.05 }) {\n    editor.on('connectionpath', data => {\n        const { connection } = data;\n        const [x1, y1, x2, y2] = data.points;\n        const pins = connection && connection.data.pins ? connection.data.pins : [];\n        const points = [[x1, y1], ...pins.map(({ x, y }) => [x, y]), [x2, y2]];\n        const transformedPoints = alignEndsHorizontally(points, curvature);\n\n        data.d = d3.line()\n            .x(d => d[0])\n            .y(d => d[1])\n            .curve(curve)\n            (transformedPoints)\n    });\n    editor.on('renderconnection', ({ el, connection }) => {\n        const path = el.querySelector('.connection path');\n        const pins = connection.data.pins || (connection.data.pins = []);\n\n        if (!path) throw new Error('<path> not found');\n\n        path.addEventListener('click', () => {\n            const { mouse } = editor.view.area;\n            const pin = { ...mouse };\n            const [x1, y1, x2, y2] = editor.view.connections.get(connection).getPoints();\n            const points = [{ x: x1, y: y1 }, ...pins, { x: x2, y: y2 }];\n            const index = findRightIndex(pin, points);\n\n            pins.splice(index, 0, pin)\n\n            app.$children[0].$forceUpdate();\n            editor.view.connections.get(connection).update();\n        });\n\n        const vueContainer = document.createElement('div');\n\n        el.appendChild(vueContainer);\n\n        const app = new Vue({\n            provide: {\n                editor,\n                connection\n            },\n            render: h => h(Pins, { props: { pins } })\n        }).$mount(vueContainer)\n    });\n\n    editor.on('export', data => {\n        data.reroute= 'hello';\n    });\n\n    editor.on('import', data => {\n        \n    });\n}\n\nexport default {\n    name: 'connection-reroute',\n    install\n}","import {path} from \"d3-path\";\nimport constant from \"./constant\";\nimport curveLinear from \"./curve/linear\";\nimport {x as pointX, y as pointY} from \"./point\";\n\nexport default function() {\n  var x = pointX,\n      y = pointY,\n      defined = constant(true),\n      context = null,\n      curve = curveLinear,\n      output = null;\n\n  function line(data) {\n    var i,\n        n = data.length,\n        d,\n        defined0 = false,\n        buffer;\n\n    if (context == null) output = curve(buffer = path());\n\n    for (i = 0; i <= n; ++i) {\n      if (!(i < n && defined(d = data[i], i, data)) === defined0) {\n        if (defined0 = !defined0) output.lineStart();\n        else output.lineEnd();\n      }\n      if (defined0) output.point(+x(d, i, data), +y(d, i, data));\n    }\n\n    if (buffer) return output = null, buffer + \"\" || null;\n  }\n\n  line.x = function(_) {\n    return arguments.length ? (x = typeof _ === \"function\" ? _ : constant(+_), line) : x;\n  };\n\n  line.y = function(_) {\n    return arguments.length ? (y = typeof _ === \"function\" ? _ : constant(+_), line) : y;\n  };\n\n  line.defined = function(_) {\n    return arguments.length ? (defined = typeof _ === \"function\" ? _ : constant(!!_), line) : defined;\n  };\n\n  line.curve = function(_) {\n    return arguments.length ? (curve = _, context != null && (output = curve(context)), line) : curve;\n  };\n\n  line.context = function(_) {\n    return arguments.length ? (_ == null ? context = output = null : output = curve(context = _), line) : context;\n  };\n\n  return line;\n}\n"],"names":["pi","Math","PI","tau","epsilon","tauEpsilon","Path","this","_x0","_y0","_x1","_y1","_","path","x","prototype","constructor","moveTo","y","closePath","lineTo","quadraticCurveTo","x1","y1","bezierCurveTo","x2","y2","arcTo","r","x0","y0","x21","y21","x01","y01","l01_2","Error","abs","x20","y20","l21_2","l20_2","l21","sqrt","l01","l","tan","acos","t01","t21","arc","a0","a1","ccw","dx","cos","dy","sin","cw","da","rect","w","h","toString","Linear","context","_context","p","point","that","_k","_x2","_y2","Cardinal","tension","CatmullRom","alpha","_alpha","areaStart","_line","areaEnd","NaN","lineStart","_point","lineEnd","_l01_a","_l12_a","_l23_a","_l01_2a","_l12_2a","_l23_2a","x23","y23","pow","a","n","b","m","custom","catmullRom","sign","slope3","h0","h1","s0","s1","min","slope2","t","t0","t1","MonotoneX","ReflectContext","_t0","Object","create","call","template","style","script","scopeId","isFunctionalTemplate","moduleIdentifier","shadowMode","createInjector","createInjectorSSR","createInjectorShadow","hook","options","render","staticRenderFns","_compiled","functional","_scopeId","$vnode","ssrContext","parent","__VUE_SSR_CONTEXT__","_registeredComponents","add","_ssrRegister","$root","$options","shadowRoot","originalRender","existing","beforeCreate","concat","isOldIE","navigator","test","userAgent","toLowerCase","HEAD","document","head","getElementsByTagName","styles","id","css","group","media","ids","Set","has","code","source","map","sources","btoa","unescape","encodeURIComponent","JSON","stringify","element","createElement","type","setAttribute","appendChild","push","styleSheet","cssText","filter","Boolean","join","index","size","textNode","createTextNode","nodes","childNodes","removeChild","length","insertBefore","addStyle","distance","point0","point1","findRightIndex","p0","p1","p2","top","bot","line","minIdx","minDist","Infinity","pointInBound","dist","findRightIndexBack","name","install","editor","curve","d3","curvature","on","data","connection","points","pins","transformedPoints","p3","p4","hx1","hx2","splice","alignEndsHorizontally","d","pointX","pointY","defined","constant","curveLinear","output","i","buffer","defined0","arguments","el","querySelector","addEventListener","pin","view","area","mouse","connections","get","getPoints","app","$children","$forceUpdate","update","vueContainer","Vue","provide","Pins","props","$mount","reroute"],"mappings":"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"}